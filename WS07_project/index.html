<!doctype html>
<html lang="fi">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Shockwave Flash</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
      .playlist-item {
        transition: background-color 0.2s;
      }
      .playlist-item:hover {
        background-color: rgba(0, 0, 0, 0.1) !important;
      }
      .playlist-item.active {
        background-color: rgba(0, 123, 255, 0.2) !important;
        font-weight: bold;
      }
      #playlist::-webkit-scrollbar {
        width: 6px;
      }
      #playlist::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.1);
        border-radius: 3px;
      }
      #playlist::-webkit-scrollbar-thumb {
        background: rgba(0, 0, 0, 0.3);
        border-radius: 3px;
      }
      /* Hide fixed player on small screens */
      @media (max-width: 1200px) {
        #fixedMusicPlayer {
          display: none !important;
        }
        #navbarMusicPlayer {
          display: block !important;
        }
      }
      @media (min-width: 1201px) {
        #navbarMusicPlayer {
          display: none !important;
        }
      }
      /* Hide fixed links box and show navbar links on small screens */
      @media (max-width: 992px) {
        #linksBox {
          display: none !important;
        }
        #navbarLinksBox {
          display: block !important;
        }
        .container.mt-5 {
          margin-left: 0 !important;
        }
        #mainContentCard {
          margin-left: 0 !important;
          margin-right: 0 !important;
        }
      }
      /* Hide navbar links box on large screens */
      @media (min-width: 993px) {
        #navbarLinksBox {
          display: none !important;
        }
      }
    </style>
  </head>
  <body>
    <!-- Music Player (Fixed - Desktop) -->
    <div id="fixedMusicPlayer" class="position-fixed end-0" style="z-index: 1050; max-width: 320px; width: 320px; top: 100px; margin: 12px;">
      <div class="card shadow-lg">
        <div class="card-header p-2 d-flex justify-content-between align-items-center">
          <small class="fw-bold">Music Player</small>
          <button class="btn btn-sm btn-outline-secondary" id="togglePlayer" type="button">
            <span id="toggleIcon">‚àí</span>
          </button>
        </div>
        <div id="playerContent">
          <div class="card-body p-2">
            <audio id="audioPlayer" preload="auto" autoplay></audio>
            
            <!-- Album Art -->
            <div class="text-center mb-2">
              <img id="albumArt" src="" alt="Album Art" style="width: 150px; height: 150px; object-fit: cover; border-radius: 4px;">
            </div>
            
            <!-- Timeline -->
            <div class="mb-2">
              <div class="d-flex justify-content-between align-items-center mb-1">
                <small id="currentTime" class="text-muted" style="font-size: 0.7em;">0:00</small>
                <small id="totalTime" class="text-muted" style="font-size: 0.7em;">0:00</small>
              </div>
              <input type="range" class="form-range" id="progressSlider" min="0" max="100" value="0" style="width: 100%; cursor: pointer;">
            </div>
            
            <div class="d-flex align-items-center gap-2 mb-2">
              <button class="btn btn-sm btn-outline-primary" id="prevBtn" type="button">‚èÆ</button>
              <button class="btn btn-sm btn-primary" id="playPauseBtn" type="button">‚è∏</button>
              <button class="btn btn-sm btn-outline-primary" id="nextBtn" type="button">‚è≠</button>
            </div>
            <div class="d-flex align-items-center gap-2 mb-2">
              <button class="btn btn-sm btn-outline-secondary" id="muteBtn" type="button">üîä</button>
              <input type="range" class="form-range" id="volumeSlider" min="0" max="100" value="20" style="flex: 1;">
              <small id="volumeDisplay" class="text-muted" style="min-width: 35px;">20%</small>
            </div>
            <div class="mb-2">
              <small class="text-muted d-block fw-bold" id="nowPlaying" style="font-size: 0.8em;">Loading...</small>
              <small class="text-muted d-block" id="trackInfo" style="font-size: 0.7em;"></small>
            </div>
            
            <!-- Playlist -->
            <div class="border-top pt-2 mt-2">
              <small class="fw-bold d-block mb-2">Playlist</small>
              <div id="playlist" style="max-height: 200px; overflow-y: auto; font-size: 0.75em;">
                <!-- Playlist items will be generated here -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light">
      <div class="container-fluid">
        <a class="navbar-brand active" aria-current="page" href="index.html"><i class="fas fa-home"></i></a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="page2.html">Animaatiot</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="page3.html">Pelit</a>
            </li>
          </ul>
          <!-- Links Box (Mobile - Inside Navbar) -->
          <div id="navbarLinksBox" class="d-lg-none mt-3 p-3 border-top">
            <div class="fw-bold mb-3">Linkkej√§</div>
            <!-- Sivustoja Section -->
            <div class="mb-3">
              <div class="fw-bold mb-2" style="font-size: 1.1em;">Sivustoja</div>
              <ul class="list-unstyled mb-0">
                <li class="mb-2">
                  <a href="https://www.newgrounds.com" target="_blank" class="text-decoration-none d-block">newgrounds.com</a>
                </li>
                <li class="mb-2">
                  <a href="https://dagobah.net" target="_blank" class="text-decoration-none d-block">dagobah.net</a>
                </li>
                <li class="mb-2">
                  <a href="https://4chan.org/f/" target="_blank" class="text-decoration-none d-block">4chan.org/f/</a>
                  <small class="text-danger d-block" style="font-size: 0.85em;">CONTENT WARNING</small>
                </li>
              </ul>
            </div>
            <hr class="my-3">
            <!-- Flash Emulaattori Section -->
            <div class="mb-3">
              <div class="fw-bold mb-2" style="font-size: 1.1em;">Flash emulaattori</div>
              <ul class="list-unstyled mb-0">
                <li class="mb-2">
                  <a href="https://ruffle.rs" target="_blank" class="text-decoration-none d-block">ruffle.rs</a>
                </li>
              </ul>
            </div>
            <hr class="my-3">
            <!-- Flash Kirjastosovellus Section -->
            <div class="mb-3">
              <div class="fw-bold mb-2" style="font-size: 1.1em;">Laaja flash kirjastosovellus integroidulla emulaattorilla</div>
              <ul class="list-unstyled mb-0">
                <li class="mb-2">
                  <a href="https://flashpointarchive.org" target="_blank" class="text-decoration-none d-block">flashpointarchive.org</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="ms-auto d-flex align-items-center gap-2">
            <!-- Music Player (Navbar - Mobile) -->
            <div id="navbarMusicPlayer" class="d-none">
              <button class="btn btn-sm btn-outline-light" id="navbarPlayerToggle" type="button" data-bs-toggle="collapse" data-bs-target="#navbarPlayerCollapse" aria-expanded="false" aria-controls="navbarPlayerCollapse">
                üéµ
              </button>
              <div class="collapse position-absolute end-0 mt-2" id="navbarPlayerCollapse" style="z-index: 1050; width: 300px; max-width: 90vw;">
                <div class="card shadow-lg">
                  <div class="card-header p-2 d-flex justify-content-between align-items-center">
                    <small class="fw-bold">Music Player</small>
                    <button class="btn btn-sm btn-outline-secondary" id="navbarTogglePlayer" type="button">
                      <span id="navbarToggleIcon">‚àí</span>
                    </button>
                  </div>
                  <div id="navbarPlayerContent">
                    <div class="card-body p-2">
                      <div class="text-center mb-2">
                        <img id="navbarAlbumArt" src="" alt="Album Art" style="width: 120px; height: 120px; object-fit: cover; border-radius: 4px;">
                      </div>
                      <!-- Timeline (Mobile) -->
                      <div class="mb-2">
                        <div class="d-flex justify-content-between align-items-center mb-1">
                          <small id="navbarCurrentTime" class="text-muted" style="font-size: 0.7em;">0:00</small>
                          <small id="navbarTotalTime" class="text-muted" style="font-size: 0.7em;">0:00</small>
                        </div>
                        <input type="range" class="form-range" id="navbarProgressSlider" min="0" max="100" value="0" style="width: 100%; cursor: pointer;">
                      </div>
                      <div class="d-flex align-items-center gap-2 mb-2">
                        <button class="btn btn-sm btn-outline-primary" id="navbarPrevBtn" type="button">‚èÆ</button>
                        <button class="btn btn-sm btn-primary" id="navbarPlayPauseBtn" type="button">‚è∏</button>
                        <button class="btn btn-sm btn-outline-primary" id="navbarNextBtn" type="button">‚è≠</button>
                      </div>
                      <div class="d-flex align-items-center gap-2 mb-2">
                        <button class="btn btn-sm btn-outline-secondary" id="navbarMuteBtn" type="button">üîä</button>
                        <input type="range" class="form-range" id="navbarVolumeSlider" min="0" max="100" value="20" style="flex: 1;">
                        <small id="navbarVolumeDisplay" class="text-muted" style="min-width: 35px;">20%</small>
                      </div>
                      <div class="mb-2">
                        <small class="text-muted d-block fw-bold" id="navbarNowPlaying" style="font-size: 0.8em;">Loading...</small>
                        <small class="text-muted d-block" id="navbarTrackInfo" style="font-size: 0.7em;"></small>
                      </div>
                      <div class="border-top pt-2 mt-2">
                        <small class="fw-bold d-block mb-2">Playlist</small>
                        <div id="navbarPlaylist" style="max-height: 150px; overflow-y: auto; font-size: 0.75em;">
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <label for="styleSelect" class="me-2" style="color: inherit;">Style:</label>
            <select id="styleSelect" class="form-select form-select-sm" style="width: auto;">
              <option value="tomorrow">Tomorrow</option>
              <option value="yotsuba-b">Yotsuba B</option>
              <option value="yotsubaclassic">Yotsubaclassic</option>
            </select>
            <script>
              // Set dropdown value immediately to prevent browser default
              (function() {
                try {
                  const savedStyle = localStorage.getItem('selectedStyle');
                  if (savedStyle && (savedStyle === 'tomorrow' || savedStyle === 'yotsuba-b' || savedStyle === 'yotsubaclassic')) {
                    const select = document.getElementById('styleSelect');
                    if (select) {
                      select.value = savedStyle;
                    }
                  }
                } catch(e) {}
              })();
            </script>
          </div>
        </div>
      </div>
    </nav>

    <!-- Links Box (Fixed Left Side) -->
    <div id="linksBox" class="position-fixed start-0" style="z-index: 1040; top: 100px; width: 200px; max-width: 20vw; margin: 12px 0 0 10px;">
      <div class="card shadow-lg">
        <div class="card-header p-2">
          <small class="fw-bold">Linkkej√§</small>
        </div>
        <div class="card-body p-2">
          <div style="font-size: 1em;">
            <!-- Sivustoja Section -->
            <div class="mb-3">
              <div class="fw-bold mb-2" style="font-size: 1.1em;">Sivustoja</div>
              <ul class="list-unstyled mb-0">
                <li class="mb-2">
                  <a href="https://www.newgrounds.com" target="_blank" class="text-decoration-none d-block">newgrounds.com</a>
                </li>
                <li class="mb-2">
                  <a href="https://dagobah.net" target="_blank" class="text-decoration-none d-block">dagobah.net</a>
                </li>
                <li class="mb-2">
                  <a href="https://4chan.org/f/" target="_blank" class="text-decoration-none d-block">4chan.org/f/</a>
                  <small class="text-danger d-block" style="font-size: 0.85em;">CONTENT WARNING</small>
                </li>
              </ul>
            </div>
            
            <hr class="my-3">
            
            <!-- Flash Emulaattori Section -->
            <div class="mb-3">
              <div class="fw-bold mb-2" style="font-size: 1.1em;">Flash emulaattori</div>
              <ul class="list-unstyled mb-0">
                <li class="mb-2">
                  <a href="https://ruffle.rs" target="_blank" class="text-decoration-none d-block">ruffle.rs</a>
                </li>
              </ul>
            </div>
            
            <hr class="my-3">
            
            <!-- Flash Kirjastosovellus Section -->
            <div class="mb-3">
              <div class="fw-bold mb-2" style="font-size: 1.1em;">Laaja flash kirjastosovellus integroidulla emulaattorilla</div>
              <ul class="list-unstyled mb-0">
                <li class="mb-2">
                  <a href="https://flashpointarchive.org" target="_blank" class="text-decoration-none d-block">flashpointarchive.org</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="container mt-5" style="margin-left: 220px;">
      <div class="row justify-content-center justify-content-lg-start">
        <div class="col-lg-9 col-md-10 col-12" style="margin-left: 5%; margin-right: auto;" id="mainContentCard">
          <div class="card">
            <div class="card-body" style="padding: 30px;">
              <h1 class="display-4 mb-4">Shockwave Flash</h1>
          <p>Shockwave Flash (my√∂hemmin Adobe Flash) oli 1990‚Äì2010‚Äëluvuilla t√§rkein alusta selaimessa py√∂riville animaatioille, peleille ja videolle, mutta se poistui lopullisesti k√§yt√∂st√§ vuoden 2020 lopussa muun muassa turvallisuus‚Äë ja yhteensopivuusongelmien sek√§ HTML5‚Äëstandardien vuoksi. Sen ymp√§rille syntyi kokonainen internet‚Äëkulttuuri (esim. Newgrounds, Miniclip, Dagobah), joka vaikutti vahvasti pelien, meemien ja fanianimaatioiden tapaan levit√§ verkossa.</p>
          
          <h2 class="mt-5 mb-3">Flashin synty ja kehitys</h2>
          <p>Flash sai alkunsa FutureWave Softwaren SmartSketch‚Äëpiirrosohjelmasta, josta kehitettiin vuonna 1996 FutureSplash Animator, kevyt vektorianimaatioty√∂kalu verkkok√§ytt√∂√∂n. Macromedia osti FutureWave'n samana vuonna ja julkaisi tuotteen nimell√§ Macromedia Flash 1.0, jonka mukana tuli ilmainen Flash Player ‚Äëselainlaajennus.</p>
          <p>Macromedia kehitti Flashia nopeasti: mukaan tulivat muun muassa MovieClip‚Äëobjektit, ActionScript‚Äëohjelmointikieli ja FLV‚Äëvideotuki, mik√§ muutti Flashin pelk√§st√§ animaatioty√∂kalusta t√§ysiveriseksi web‚Äësovellusalustaksi. Vuonna 2005 Adobe osti Macromedian ja jatkoi Flashin kehitt√§mist√§ Creative Suite / Creative Cloud ‚Äëosana aina siihen asti, kunnes teknologia p√§√§tettiin ajaa alas.</p>
          
          <div class="card my-4" style="max-width: 600px;">
            <img src="images/02.jpg" class="card-img-top enlargeable-image" alt="Macromedia Flash asennus" style="width: 100%; height: auto; cursor: pointer;">
            <div class="card-body p-2">
              <p class="card-text small mb-0" style="font-size: 0.85em;">kuvituskuva: macromedia flash asennus</p>
            </div>
          </div>
          
          <h2 class="mt-5 mb-3">Hy√∂dyt ja vahvuudet</h2>
          <p>Flashin suurin etu oli kevyt vektorigrafiikka yhdistettyn√§ animaatio‚Äë ja interaktioty√∂kaluihin, mik√§ mahdollisti n√§ytt√§v√§t animaatiot ja pelit silloisilla hitailla yhteyksill√§. Flash Player ‚Äëlis√§osa oli ilmainen ja asennettuna l√§hes kaikkiin selaimiin, joten sis√§ll√∂ntuottajat pystyiv√§t tavoittamaan valtavan yleis√∂n yhdell√§ formaatilla.</p>
          <p>ActionScriptin kautta Flashista tuli my√∂s pelimoottori ja UI‚Äëalusta: kehitt√§j√§t pystyiv√§t rakentamaan r√§√§t√§l√∂ityj√§ k√§ytt√∂liittymi√§, nettivideoalustoja ja selaimessa toimivia pelej√§ ilman erillisi√§ plugineja tai natiivisovelluksia.</p>
          
          <div class="card my-4" style="max-width: 600px;">
            <img src="images/flashprocc_videoexport.png" class="card-img-top enlargeable-image" alt="Flash prosessointi ja videoexport" style="width: 100%; height: auto; cursor: pointer;">
            <div class="card-body p-2">
              <p class="card-text small mb-0" style="font-size: 0.85em;">Flash oli suhteellisen helposti opittava k√§ytt√∂liittym√§ pelien ja animaatioiden luomiseen</p>
            </div>
          </div>
          
          <h2 class="mt-5 mb-3">Haitat ja ongelmat</h2>
          <p>Flash Playerista l√∂ytyi vuosien varrella runsaasti tietoturvahaavoittuvuuksia, jotka tekiv√§t siit√§ suositun hy√∂kk√§yskohteen haittaohjelmien levityksess√§. Lis√§ksi liit√§nn√§inen kulutti paljon prosessoritehoa ja akkua, etenkin kannettavilla ja mobiililaitteilla, mik√§ heikensi suorituskyky√§ ja k√§ytt√∂kokemusta.</p>
          <p>Koska Flash perustui suljettuun liit√§nn√§iseen, se oli huonosti yhteensopiva avoimien web‚Äëstandardien ajatuksen kanssa, ja tuki mobiiliselaimissa j√§i rajoitetuksi (tunnettu esimerkki on Applen p√§√§t√∂s olla tukematta Flashia iOS:ss√§).</p>
          
          <div class="card my-4" style="max-width: 600px;">
            <img src="images/2015-06-21-21-22-41-3ead30.png" class="card-img-top enlargeable-image" alt="Flash kulttuuri" style="width: 100%; height: auto; cursor: pointer;">
            <div class="card-body p-2">
              <p class="card-text small mb-0" style="font-size: 0.85em;">Flashia t√§ytyi p√§ivitt√§√§ usein tietoturvasyist√§</p>
            </div>
          </div>
          
          <h2 class="mt-5 mb-3">Flash‚Äëkulttuuri ja pelisivustot</h2>
          <p>Flashin ymp√§rille syntyi valtava indie‚Äëpelien ja animaatioiden ekosysteemi, jossa Newgrounds toimi t√§rkeimp√§n√§ yhteis√∂alustana amat√∂√∂ri‚Äë ja harrastelijakehitt√§jille. Newgroundsista nousi useita tunnettuja tekij√∂it√§ ja sarjoja, ja sivustolla jaettiin niin kokeellisia animaatioita, huumorisket≈°ej√§ kuin varhaisia prototyyppej√§ my√∂hemmin kaupallisiksi peleiksi p√§√§tyneist√§ ideoista.</p>
          <p>Dagobah Flash Gallery ker√§si laajan kokoelman looppeja, meemej√§, pelej√§ ja musiikkivideoita, joissa n√§kyi vahvasti 2000‚Äëluvun verkkohuumori ja otaku‚Äëkulttuuri. Miniclip ja vastaavat pelisivut toivat Flash‚Äëpelit valtavirtaan, tarjoten valtavia katalogeja helposti pelattavia selainpelej√§ koulu‚Äë ja ty√∂paikkataukojen ajanvietteeksi.</p>
          
          <div class="card my-4" style="max-width: 600px;">
            <img src="images/newgrounds.jpg" class="card-img-top enlargeable-image" alt="Newgrounds" style="width: 100%; height: auto; cursor: pointer;">
            <div class="card-body p-2">
              <p class="card-text small mb-0" style="font-size: 0.85em;">Newgrounds-sivuston julkisivu vuodelta 2008</p>
            </div>
          </div>
          
          <h2 class="mt-5 mb-3">Foorumit, meemit ja alikulttuurit</h2>
          <p>2chan ja 4chan levittiv√§t paljon Flash‚Äësis√§lt√∂√§, kuten loopattuja animaatioita, parodioita ja faniteoksia, jotka levisiv√§t linkkein√§ ja upotuksina ymp√§ri verkkoa. N√§iden anonyymien foorumien kulttuuri vaikutti sek√§ sis√§lt√∂jen tyyliin (absurdi, provosoiva huumori) ett√§ siihen, miten nopeasti Flash‚Äëanimaatioista syntyi kansainv√§lisi√§ meemej√§.</p>
          <p>Flashin tuottajat ja tekij√§t vaihtelivat yksitt√§isist√§ harrastelijoista pieniin studioihin, ja osa heist√§ siirtyi my√∂hemmin kaupallisiin pelitaloihin tai animaatiostudioihin, kun Flash‚Äëmaine toi n√§kyvyytt√§. T√§m√§ kausi loi pohjaa monille nykyisille indie‚Äëpelinkehitt√§jille ja YouTube‚Äëanimaattoreille, jotka aloittivat uransa juuri Flashilla.</p>
          
          <div class="card my-4" style="max-width: 600px;">
            <img src="images/4chanf.webp" class="card-img-top enlargeable-image" alt="4chan /f/" style="width: 100%; height: auto; cursor: pointer;">
            <div class="card-body p-2">
              <p class="card-text small mb-0" style="font-size: 0.85em;">4chan /f/ ei v√§ltt√§m√§tt√§ sovi herkimmille</p>
            </div>
          </div>
          
          <h2 class="mt-5 mb-3">Miksi Flash lopetettiin?</h2>
          <p>Adobe ilmoitti vuonna 2017 lopettavansa Flash Playerin jakelun ja p√§ivitykset vuoden 2020 lopussa, ja tuki p√§√§ttyi virallisesti 31.12.2020, mink√§ j√§lkeen Flash‚Äësis√§lt√∂ estettiin oletuksena. P√§√§t√∂ksen taustalla olivat muun muassa tietoturvariskit, heikko mobiilituki ja se, ett√§ HTML5, CSS3 ja JavaScript tarjosivat avoimet ja tehokkaammat tavat toteuttaa animaatioita, videoita ja interaktiivisia sovelluksia.</p>
          <p>Selainvalmistajat (Chrome, Firefox, Edge, Safari) ajoivat Flash‚Äëtuen asteittain alas, mik√§ teki plug‚Äëinist√§ k√§yt√§nn√∂ss√§ k√§ytt√∂kelvottoman tavallisille k√§ytt√§jille. Samalla osa yhteis√∂ist√§ ryhtyi arkistoimaan klassisia Flash‚Äëpelej√§ ja animaatioita emulaattorien ja konversioty√∂kalujen avulla, jotta Flash‚Äëkulttuurin perint√∂ s√§ilyisi my√∂s ilman alkuper√§ist√§ liit√§nn√§ist√§.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Image Modal -->
    <div class="modal fade" id="imageModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-body text-center p-0 position-relative">
            <button type="button" class="btn-close position-absolute top-0 end-0 m-2" data-bs-dismiss="modal" aria-label="Close" style="z-index: 10; background-color: rgba(255, 255, 255, 0.8);"></button>
            <img id="modalImage" src="" alt="" style="max-width: 100%; height: auto;">
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="styles.js"></script>
    <script>
      // Image enlargement functionality
      document.addEventListener('DOMContentLoaded', function() {
        const enlargeableImages = document.querySelectorAll('.enlargeable-image');
        const imageModal = new bootstrap.Modal(document.getElementById('imageModal'));
        const modalImage = document.getElementById('modalImage');

        enlargeableImages.forEach(function(img) {
          img.addEventListener('click', function() {
            modalImage.src = this.src;
            modalImage.alt = this.alt;
            imageModal.show();
          });
        });

        // Close modal when clicking outside the image
        document.getElementById('imageModal').addEventListener('click', function(e) {
          if (e.target === this) {
            imageModal.hide();
          }
        });
      });

      // Format time helper function
      function formatTime(seconds) {
        if (isNaN(seconds) || !isFinite(seconds)) return '0:00';
        const mins = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return mins + ':' + (secs < 10 ? '0' : '') + secs;
      }

      // Function to fix music player text colors for Tomorrow theme
      function fixMusicPlayerTextColors() {
        const selectedStyle = localStorage.getItem('selectedStyle') || 'yotsubaclassic';
        const elements = [
          document.getElementById('currentTime'),
          document.getElementById('totalTime'),
          document.getElementById('volumeDisplay'),
          document.getElementById('nowPlaying'),
          document.getElementById('trackInfo'),
          document.getElementById('navbarCurrentTime'),
          document.getElementById('navbarTotalTime'),
          document.getElementById('navbarVolumeDisplay'),
          document.getElementById('navbarNowPlaying'),
          document.getElementById('navbarTrackInfo')
        ];
        
        elements.forEach(el => {
          if (el) {
            if (selectedStyle === 'tomorrow') {
              el.style.setProperty('color', '#c5c8c6', 'important');
              el.classList.remove('text-muted');
              el.classList.add('tomorrow-text');
            } else {
              el.classList.remove('tomorrow-text');
              if (!el.classList.contains('text-muted')) {
                el.classList.add('text-muted');
              }
              el.style.removeProperty('color');
            }
          }
        });
      }

      // Music Player functionality
      document.addEventListener('DOMContentLoaded', function() {
        const audioPlayer = document.getElementById('audioPlayer');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const progressSlider = document.getElementById('progressSlider');
        const currentTime = document.getElementById('currentTime');
        const totalTime = document.getElementById('totalTime');
        const navbarProgressSlider = document.getElementById('navbarProgressSlider');
        const navbarCurrentTime = document.getElementById('navbarCurrentTime');
        const navbarTotalTime = document.getElementById('navbarTotalTime');
        const volumeSlider = document.getElementById('volumeSlider');
        const muteBtn = document.getElementById('muteBtn');
        const volumeDisplay = document.getElementById('volumeDisplay');
        const nowPlaying = document.getElementById('nowPlaying');
        const trackInfo = document.getElementById('trackInfo');
        const togglePlayer = document.getElementById('togglePlayer');
        const playerContent = document.getElementById('playerContent');
        const toggleIcon = document.getElementById('toggleIcon');
        const albumArt = document.getElementById('albumArt');
        const playlistContainer = document.getElementById('playlist');
        
        // Navbar player elements
        const navbarAlbumArt = document.getElementById('navbarAlbumArt');
        const navbarPlayPauseBtn = document.getElementById('navbarPlayPauseBtn');
        const navbarPrevBtn = document.getElementById('navbarPrevBtn');
        const navbarNextBtn = document.getElementById('navbarNextBtn');
        const navbarVolumeSlider = document.getElementById('navbarVolumeSlider');
        const navbarMuteBtn = document.getElementById('navbarMuteBtn');
        const navbarVolumeDisplay = document.getElementById('navbarVolumeDisplay');
        const navbarNowPlaying = document.getElementById('navbarNowPlaying');
        const navbarTrackInfo = document.getElementById('navbarTrackInfo');
        const navbarTogglePlayer = document.getElementById('navbarTogglePlayer');
        const navbarPlayerContent = document.getElementById('navbarPlayerContent');
        const navbarToggleIcon = document.getElementById('navbarToggleIcon');
        const navbarPlaylistContainer = document.getElementById('navbarPlaylist');

        // Playlist with all FLAC files from music folder
        const playlist = [
          { src: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/01 Duhicebdo ed varicecag parvabiguf.flac', title: '01 Duhicebdo ed varicecag parvabiguf', album: '[2018] ‚ñë ‚ñí ‚ñì ‚ñà', art: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/cover.jpg' },
          { src: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/02 Igparera fihi gexigug igpariug afc.flac', title: '02 Igparera fihi gexigug igpariug afc', album: '[2018] ‚ñë ‚ñí ‚ñì ‚ñà', art: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/cover.jpg' },
          { src: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/03 E puro fobca dafluic eque pure.flac', title: '03 E puro fobca dafluic eque pure', album: '[2018] ‚ñë ‚ñí ‚ñì ‚ñà', art: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/cover.jpg' },
          { src: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/04 Ohfaquiug egidof, varicef odiug peric.flac', title: '04 Ohfaquiug egidof, varicef odiug peric', album: '[2018] ‚ñë ‚ñí ‚ñì ‚ñà', art: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/cover.jpg' },
          { src: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/05 Eliabe vicie ib odulif hehaguf e cargo bofcre fubc.flac', title: '05 Eliabe vicie ib odulif hehaguf e cargo bofcre fubc', album: '[2018] ‚ñë ‚ñí ‚ñì ‚ñà', art: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/cover.jpg' },
          { src: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/06 Baqua irefdi, baqua edgireri, fad ibcalligara.flac', title: '06 Baqua irefdi, baqua edgireri, fad ibcalligara', album: '[2018] ‚ñë ‚ñí ‚ñì ‚ñà', art: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/cover.jpg' },
          { src: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/07 Becureg axpallef furde. Cegab ufqua radurrac.flac', title: '07 Becureg axpallef furde. Cegab ufqua radurrac', album: '[2018] ‚ñë ‚ñí ‚ñì ‚ñà', art: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/cover.jpg' },
          { src: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/08 Baqua ighallag farodaf progabarebc equilea dolugheg.flac', title: '08 Baqua ighallag farodaf progabarebc equilea dolugheg', album: '[2018] ‚ñë ‚ñí ‚ñì ‚ñà', art: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/cover.jpg' },
          { src: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/09 Lax ubivarfe afc, quea iuhac befdi ac gori.flac', title: '09 Lax ubivarfe afc, quea iuhac befdi ac gori', album: '[2018] ‚ñë ‚ñí ‚ñì ‚ñà', art: 'music/[2018] ‚ñë ‚ñí ‚ñì ‚ñà/cover.jpg' },
          { src: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/01 H A R E K L A V I T.flac', title: '01 H A R E K L A V I T', album: '[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë', art: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/cover.jpg' },
          { src: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/02 T I L A S K A R O T.flac', title: '02 T I L A S K A R O T', album: '[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë', art: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/cover.jpg' },
          { src: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/03 G E B U E R J E I T.flac', title: '03 G E B U E R J E I T', album: '[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë', art: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/cover.jpg' },
          { src: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/04 F A R B A S K E I N.flac', title: '04 F A R B A S K E I N', album: '[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë', art: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/cover.jpg' },
          { src: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/05 A S G R E T A L O S.flac', title: '05 A S G R E T A L O S', album: '[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë', art: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/cover.jpg' },
          { src: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/06 D I L E R K E F E T.flac', title: '06 D I L E R K E F E T', album: '[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë', art: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/cover.jpg' },
          { src: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/07 B A R E G E R E S K.flac', title: '07 B A R E G E R E S K', album: '[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë', art: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/cover.jpg' },
          { src: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/08 L A D I K E R F O S.flac', title: '08 L A D I K E R F O S', album: '[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë', art: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/cover.jpg' },
          { src: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/09 S E V E R K E T O R.flac', title: '09 S E V E R K E T O R', album: '[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë', art: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/cover.jpg' },
          { src: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/10 V A R E C K J E I T.flac', title: '10 V A R E C K J E I T', album: '[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë', art: 'music/[2021] ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë/cover.jpg' },
          { src: 'music/[2024] Nel nome del codice/01 Se hai timore del vero.flac', title: '01 Se hai timore del vero', album: '[2024] Nel nome del codice', art: 'music/[2024] Nel nome del codice/cover.jpg' },
          { src: 'music/[2024] Nel nome del codice/02 La chiave del mio amor.flac', title: '02 La chiave del mio amor', album: '[2024] Nel nome del codice', art: 'music/[2024] Nel nome del codice/cover.jpg' },
          { src: 'music/[2024] Nel nome del codice/03 Sulla via della gloria.flac', title: '03 Sulla via della gloria', album: '[2024] Nel nome del codice', art: 'music/[2024] Nel nome del codice/cover.jpg' },
          { src: 'music/[2024] Nel nome del codice/04 Nel nome del codice.flac', title: '04 Nel nome del codice', album: '[2024] Nel nome del codice', art: 'music/[2024] Nel nome del codice/cover.jpg' },
          { src: 'music/[2024] Nel nome del codice/05 Lode al disco sacro.flac', title: '05 Lode al disco sacro', album: '[2024] Nel nome del codice', art: 'music/[2024] Nel nome del codice/cover.jpg' },
          { src: 'music/[2024] Nel nome del codice/06 Il paradiso dell\'anima.flac', title: '06 Il paradiso dell\'anima', album: '[2024] Nel nome del codice', art: 'music/[2024] Nel nome del codice/cover.jpg' },
          { src: 'music/[2024] Nel nome del codice/07 La voce del destino.flac', title: '07 La voce del destino', album: '[2024] Nel nome del codice', art: 'music/[2024] Nel nome del codice/cover.jpg' },
          { src: 'music/[2024] Nel nome del codice/08 Che sia vita o morte.flac', title: '08 Che sia vita o morte', album: '[2024] Nel nome del codice', art: 'music/[2024] Nel nome del codice/cover.jpg' },
          { src: 'music/[2024] Nel nome del codice/09 Sempre nel mio pensiero.flac', title: '09 Sempre nel mio pensiero', album: '[2024] Nel nome del codice', art: 'music/[2024] Nel nome del codice/cover.jpg' }
        ];

        let currentTrack = 0;
        let isMuted = false;
        let previousVolume = 20;

        // Set initial volume to 20%
        audioPlayer.volume = 0.2;
        volumeSlider.value = 20;

        // Load first track
        function loadTrack(index, shouldPlay = false) {
          if (index >= 0 && index < playlist.length) {
            currentTrack = index;
            audioPlayer.src = playlist[currentTrack].src;
            
            // Update both players
            nowPlaying.textContent = playlist[currentTrack].title;
            trackInfo.textContent = playlist[currentTrack].album;
            albumArt.src = playlist[currentTrack].art;
            albumArt.alt = playlist[currentTrack].album;
            
            if (navbarNowPlaying) {
              navbarNowPlaying.textContent = playlist[currentTrack].title;
              navbarTrackInfo.textContent = playlist[currentTrack].album;
              navbarAlbumArt.src = playlist[currentTrack].art;
              navbarAlbumArt.alt = playlist[currentTrack].album;
            }
            
            audioPlayer.load();
            
            // Update playlist highlighting
            updatePlaylistHighlight();
            
            if (shouldPlay) {
              // Try to play immediately when track is ready
              const tryPlay = function() {
                audioPlayer.play().then(function() {
                  playPauseBtn.textContent = '‚è∏';
                  if (navbarPlayPauseBtn) navbarPlayPauseBtn.textContent = '‚è∏';
                }).catch(function(error) {
                  // Play attempt failed
                });
              };
              
              // Try multiple times to ensure playback starts
              audioPlayer.addEventListener('canplay', tryPlay, { once: true });
              audioPlayer.addEventListener('loadeddata', tryPlay, { once: true });
              // Also try immediately
              setTimeout(tryPlay, 100);
            }
          }
        }

        // Update playlist highlighting
        function updatePlaylistHighlight() {
          const playlistItems = playlistContainer.querySelectorAll('.playlist-item');
          playlistItems.forEach(function(item, index) {
            if (index === currentTrack) {
              item.classList.add('active');
            } else {
              item.classList.remove('active');
            }
          });
          
          if (navbarPlaylistContainer) {
            const navbarPlaylistItems = navbarPlaylistContainer.querySelectorAll('.playlist-item');
            navbarPlaylistItems.forEach(function(item, index) {
              if (index === currentTrack) {
                item.classList.add('active');
              } else {
                item.classList.remove('active');
              }
            });
          }
        }

        // Create playlist UI
        function createPlaylist() {
          playlistContainer.innerHTML = '';
          if (navbarPlaylistContainer) navbarPlaylistContainer.innerHTML = '';
          
          playlist.forEach(function(track, index) {
            // Fixed player playlist
            const item = document.createElement('div');
            item.className = 'playlist-item d-flex align-items-center p-1 mb-1 rounded';
            item.style.cursor = 'pointer';
            item.innerHTML = '<span class="me-2" style="font-size: 0.7em;">' + (index + 1) + '.</span><span style="flex: 1; font-size: 0.75em;">' + track.title + '</span>';
            
            item.addEventListener('click', function() {
              loadTrack(index, true);
            });
            
            playlistContainer.appendChild(item);
            
            // Navbar player playlist
            if (navbarPlaylistContainer) {
              const navbarItem = document.createElement('div');
              navbarItem.className = 'playlist-item d-flex align-items-center p-1 mb-1 rounded';
              navbarItem.style.cursor = 'pointer';
              navbarItem.innerHTML = '<span class="me-2" style="font-size: 0.7em;">' + (index + 1) + '.</span><span style="flex: 1; font-size: 0.75em;">' + track.title + '</span>';
              
              navbarItem.addEventListener('click', function() {
                loadTrack(index, true);
              });
              
              navbarPlaylistContainer.appendChild(navbarItem);
            }
          });
          updatePlaylistHighlight();
        }

        // Play/Pause
        function togglePlayPause() {
          if (audioPlayer.paused) {
            audioPlayer.play();
            playPauseBtn.textContent = '‚è∏';
            if (navbarPlayPauseBtn) navbarPlayPauseBtn.textContent = '‚è∏';
          } else {
            audioPlayer.pause();
            playPauseBtn.textContent = '‚ñ∂';
            if (navbarPlayPauseBtn) navbarPlayPauseBtn.textContent = '‚ñ∂';
          }
        }
        playPauseBtn.addEventListener('click', togglePlayPause);
        if (navbarPlayPauseBtn) navbarPlayPauseBtn.addEventListener('click', togglePlayPause);

        // Previous track
        function playPrevious() {
          currentTrack = (currentTrack - 1 + playlist.length) % playlist.length;
          loadTrack(currentTrack, true);
        }
        prevBtn.addEventListener('click', playPrevious);
        if (navbarPrevBtn) navbarPrevBtn.addEventListener('click', playPrevious);

        // Next track
        function playNext() {
          currentTrack = (currentTrack + 1) % playlist.length;
          loadTrack(currentTrack, true);
        }
        nextBtn.addEventListener('click', playNext);
        if (navbarNextBtn) navbarNextBtn.addEventListener('click', playNext);

        // Volume control
        function updateVolume(value) {
          const volume = value / 100;
          audioPlayer.volume = volume;
          volumeDisplay.textContent = value + '%';
          if (navbarVolumeDisplay) navbarVolumeDisplay.textContent = value + '%';
          if (navbarVolumeSlider) navbarVolumeSlider.value = value;
          if (volume > 0) {
            isMuted = false;
            muteBtn.textContent = 'üîä';
            if (navbarMuteBtn) navbarMuteBtn.textContent = 'üîä';
          }
        }
        volumeSlider.addEventListener('input', function() {
          updateVolume(this.value);
        });
        if (navbarVolumeSlider) {
          navbarVolumeSlider.addEventListener('input', function() {
            updateVolume(this.value);
            volumeSlider.value = this.value;
          });
        }

        // Mute button
        function toggleMute() {
          if (isMuted) {
            audioPlayer.volume = previousVolume / 100;
            volumeSlider.value = previousVolume;
            if (navbarVolumeSlider) navbarVolumeSlider.value = previousVolume;
            volumeDisplay.textContent = previousVolume + '%';
            if (navbarVolumeDisplay) navbarVolumeDisplay.textContent = previousVolume + '%';
            muteBtn.textContent = 'üîä';
            if (navbarMuteBtn) navbarMuteBtn.textContent = 'üîä';
            isMuted = false;
          } else {
            previousVolume = volumeSlider.value;
            audioPlayer.volume = 0;
            volumeSlider.value = 0;
            if (navbarVolumeSlider) navbarVolumeSlider.value = 0;
            volumeDisplay.textContent = '0%';
            if (navbarVolumeDisplay) navbarVolumeDisplay.textContent = '0%';
            muteBtn.textContent = 'üîá';
            if (navbarMuteBtn) navbarMuteBtn.textContent = 'üîá';
            isMuted = true;
          }
        }
        muteBtn.addEventListener('click', toggleMute);
        if (navbarMuteBtn) navbarMuteBtn.addEventListener('click', toggleMute);

        // Update timeline
        function updateTimeline() {
          if (audioPlayer.duration) {
            const progress = (audioPlayer.currentTime / audioPlayer.duration) * 100;
            progressSlider.value = progress;
            if (navbarProgressSlider) navbarProgressSlider.value = progress;
            currentTime.textContent = formatTime(audioPlayer.currentTime);
            if (navbarCurrentTime) navbarCurrentTime.textContent = formatTime(audioPlayer.currentTime);
            totalTime.textContent = formatTime(audioPlayer.duration);
            if (navbarTotalTime) navbarTotalTime.textContent = formatTime(audioPlayer.duration);
          }
        }

        // Update timeline on timeupdate
        audioPlayer.addEventListener('timeupdate', updateTimeline);
        
        // Update total time when metadata is loaded
        audioPlayer.addEventListener('loadedmetadata', function() {
          totalTime.textContent = formatTime(audioPlayer.duration);
          if (navbarTotalTime) navbarTotalTime.textContent = formatTime(audioPlayer.duration);
        });

        // Seek functionality
        let isSeeking = false;
        progressSlider.addEventListener('input', function() {
          isSeeking = true;
          if (audioPlayer.duration) {
            const seekTime = (this.value / 100) * audioPlayer.duration;
            currentTime.textContent = formatTime(seekTime);
            if (navbarCurrentTime) navbarCurrentTime.textContent = formatTime(seekTime);
          }
        });
        progressSlider.addEventListener('change', function() {
          if (audioPlayer.duration) {
            audioPlayer.currentTime = (this.value / 100) * audioPlayer.duration;
          }
          isSeeking = false;
        });
        
        if (navbarProgressSlider) {
          navbarProgressSlider.addEventListener('input', function() {
            isSeeking = true;
            if (audioPlayer.duration) {
              const seekTime = (this.value / 100) * audioPlayer.duration;
              currentTime.textContent = formatTime(seekTime);
              if (navbarCurrentTime) navbarCurrentTime.textContent = formatTime(seekTime);
            }
          });
          navbarProgressSlider.addEventListener('change', function() {
            if (audioPlayer.duration) {
              audioPlayer.currentTime = (this.value / 100) * audioPlayer.duration;
            }
            isSeeking = false;
          });
        }

        // Fix music player text colors
        fixMusicPlayerTextColors();
        
        // Fix colors after page loads
        window.addEventListener('load', function() {
          setTimeout(fixMusicPlayerTextColors, 100);
        });
        
        // Fix colors when style changes
        window.addEventListener('styleChanged', function() {
          setTimeout(fixMusicPlayerTextColors, 50);
        });
        
        window.addEventListener('storage', function(e) {
          if (e.key === 'selectedStyle') {
            setTimeout(fixMusicPlayerTextColors, 50);
          }
        });

        audioPlayer.addEventListener('play', function() {
          playPauseBtn.textContent = '‚è∏';
          if (navbarPlayPauseBtn) navbarPlayPauseBtn.textContent = '‚è∏';
        });
        audioPlayer.addEventListener('pause', function() {
          playPauseBtn.textContent = '‚ñ∂';
          if (navbarPlayPauseBtn) navbarPlayPauseBtn.textContent = '‚ñ∂';
        });

        // Auto-play next track
        audioPlayer.addEventListener('ended', function() {
          currentTrack = (currentTrack + 1) % playlist.length;
          loadTrack(currentTrack, true);
        });

        // Toggle player collapse
        togglePlayer.addEventListener('click', function() {
          if (playerContent.style.display === 'none') {
            playerContent.style.display = 'block';
            toggleIcon.textContent = '‚àí';
          } else {
            playerContent.style.display = 'none';
            toggleIcon.textContent = '+';
          }
        });
        
        if (navbarTogglePlayer) {
          navbarTogglePlayer.addEventListener('click', function() {
            if (navbarPlayerContent.style.display === 'none') {
              navbarPlayerContent.style.display = 'block';
              navbarToggleIcon.textContent = '‚àí';
            } else {
              navbarPlayerContent.style.display = 'none';
              navbarToggleIcon.textContent = '+';
            }
          });
        }

        // Initialize playlist and start playing immediately
        createPlaylist();
        loadTrack(0, true);
        
        // Additional autoplay attempts
        window.addEventListener('load', function() {
          setTimeout(function() {
            audioPlayer.play().then(function() {
              playPauseBtn.textContent = '‚è∏';
            }).catch(function(error) {
              // Autoplay blocked
            });
          }, 200);
        });
        
        // Try to play when user interacts with page (fallback)
        document.addEventListener('click', function() {
          if (audioPlayer.paused) {
            audioPlayer.play().then(function() {
              playPauseBtn.textContent = '‚è∏';
            });
          }
        }, { once: true });
      });
    </script>
  </body>
</html>

